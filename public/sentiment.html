<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title data-i18n="title-us">미국 주식 공포 탐욕 지수 - CNN Fear & Greed Index 분석 | anse.ai</title>
<meta name="description" content="미국 주식 시장의 실시간 공포 탐욕 지수(CNN Fear & Greed Index)를 확인하세요. S&P 500 모멘텀, 변동성, 옵션 데이터를 바탕으로 전문적인 시장 심리 분석을 제공합니다." data-i18n="desc-us"/>
<link rel="canonical" href="https://anse.ai.kr/sentiment.html"/>

<!-- Open Graph / Facebook -->
<meta property="og:site_name" content="anse.ai - 주식 시장 심리 분석"/>
<meta property="og:title" content="미국 주식 공포 탐욕 지수 - CNN Fear & Greed Index 분석" data-i18n="title-us"/>
<meta property="og:description" content="미국 주식 시장의 투자 심리를 한눈에 파악하세요." data-i18n="desc-us"/>
<meta property="og:type" content="website"/>
<meta property="og:url" content="https://anse.ai.kr/sentiment.html"/>
<meta property="og:image" content="https://anse.ai.kr/images/neutral.png"/>
<meta name="author" content="anse.ai"/>

<!-- Twitter -->
<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:title" content="미국 주식 공포 탐욕 지수 - CNN Fear & Greed Index 분석" data-i18n="title-us"/>
<meta name="twitter:description" content="미국 주식 시장의 투자 심리를 한눈에 파악하세요." data-i18n="desc-us"/>
<meta name="twitter:image" content="https://anse.ai.kr/images/neutral.png"/>

<!-- Structured Data (JSON-LD) -->
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "WebPage",
  "name": "anse.ai US Fear & Greed Index Analysis",
  "url": "https://anse.ai.kr/sentiment.html",
  "description": "Analysis of US stock market sentiment using CNN Business Fear & Greed Index components.",
  "mainEntity": [
    {
      "@type": "Question",
      "name": "미국 공포 탐욕 지수란 무엇인가요?",
      "acceptedAnswer": {
        "@type": "Answer",
        "text": "미국 주식 시장의 투자 심리를 측정하기 위해 CNN Business에서 개발한 지수입니다. 시장의 모멘텀, 주가 강도, 옵션 거래량 등 7가지 요소를 종합하여 산출합니다."
      }
    }
  ]
}
</script>

<!-- Existing styles and icons -->
<link rel="icon" type="image/x-icon" href="images/favicon.ico"/>

<!-- Tailwind CSS and Fonts -->
<script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
<script src="translations.js"></script>
<script src="proverbs.js"></script>
<script src="i18n.js"></script>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;900&amp;display=swap" rel="stylesheet"/>
<link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:wght,FILL@100..700,0..1&amp;display=swap" rel="stylesheet"/>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
<script src="header.js" defer></script>
<script id="tailwind-config">
        tailwind.config = {
            darkMode: "class",
            theme: {
                extend: {
                    colors: {
                        "primary": "#3d84f5",
                        "background-light": "#f5f7f8",
                        "background-dark": "#101722",
                    },
                    fontFamily: {
                        "display": ["Inter", "sans-serif"]
                    },
                    borderRadius: {"DEFAULT": "0.25rem", "lg": "0.5rem", "xl": "0.75rem", "full": "9999px"},
                },
            },
        }
    </script>
<style>
        body { font-family: 'Inter', sans-serif; }
        .material-symbols-outlined { font-variation-settings: 'FILL' 0, 'wght' 400, 'GRAD' 0, 'OPSZ' 24; }
        .gauge-gradient {
            background: conic-gradient(from 180deg at 50% 100%, #f87171 0deg, #fbbf24 90deg, #3d84f5 180deg);
        }
        /* Language-specific display rules */
        html[lang="ko"] .lang-en { display: none !important; }
        html[lang="en"] .lang-ko { display: none !important; }
    </style>

<!-- Google Analytics and Clarity -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-C8QR98TVTB"></script>
<script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-C8QR98TVTB');
    </script>

<script type="text/javascript">
        (function(c,l,a,r,i,t,y){
            c[a]=c[a]||function(){(c[a].q=c[a].q||[]).push(arguments)};
            t=l.createElement(r);t.async=1;t.src="https://www.clarity.ms/tag/"+i;
            y=l.getElementsByTagName(r)[0];y.parentNode.insertBefore(t,y);
        })(window, document, "clarity", "script", "v2qmp0i82b");
    </script>

<script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "Article",
      "headline": "미국 금융시장 심리",
      "url": "https://anse.ai.kr/sentiment.html",
      "description": "미국 주식시장의 공포 탐욕 지수를 확인하고 투자에 참고하세요.",
      "datePublished": "2026-01-17",
      "author": {
        "@type": "Person",
        "name": "anse"
      }
    }
    </script>

</head>
<body class="min-h-screen bg-background-light dark:bg-background-dark text-slate-900 dark:text-slate-200">
    <div id="header-placeholder"></div>

<main class="mx-auto max-w-[1200px] px-6 py-8">
<!-- Page Heading -->
<div class="mb-8 flex flex-wrap items-end justify-between gap-8">
<div class="flex flex-col gap-1">
<h1 class="text-3xl font-black tracking-tight dark:text-white" data-i18n="title-us">US Market Sentiment</h1>
<p class="text-base text-[#49699c] dark:text-slate-400" data-i18n="us-sentiment-analysis-desc">CNN Business Fear &amp; Greed Index analysis.</p>
</div>
<div id="market-status-indicator" class="flex items-center gap-2 rounded-full bg-slate-100 dark:bg-slate-800 px-6 py-2 text-xs font-bold text-slate-600 dark:text-slate-400">
    <span id="market-status-dot" class="h-2 w-2 rounded-full bg-emerald-500 animate-pulse"></span>
    <span id="market-status-text" data-i18n="updating">Updating...</span>
</div>
<div class="grid grid-cols-1 gap-8 lg:grid-cols-12">
<!-- Main Gauge Section -->
<div class="lg:col-span-8">
<div class="flex flex-col overflow-hidden rounded-xl border border-[#e7ecf4] dark:border-[#1e293b] bg-white dark:bg-[#161f2c] p-8 shadow-sm">
<div class="mb-4 flex flex-wrap items-center justify-between gap-3">
<h3 class="text-lg font-bold" data-i18n="current-sentiment">Current Sentiment</h3>
<span id="last-updated-time" class="text-sm font-medium text-[#49699c]"><span data-i18n="last-updated">Last updated</span>: -</span>
</div>
<div class="relative flex flex-col items-center py-10">
<!-- Gauge visualization -->
<div class="relative h-48 w-80 overflow-hidden rounded-t-full bg-slate-100 dark:bg-slate-800">
<!-- Gauge segments colored with conic gradient -->
<div class="absolute inset-0 gauge-gradient opacity-80" style="clip-path: polygon(0 0, 100% 0, 100% 100%, 0 100%);"></div>
<div class="absolute bottom-0 left-1/2 h-32 w-64 -translate-x-1/2 rounded-t-full bg-white dark:bg-[#161f2c]"></div>
<!-- Needle -->
<div class="absolute bottom-0 left-1/2 h-40 w-1 -translate-x-1/2 origin-bottom transition-transform duration-1000 ease-out" id="gauge-needle">
<div class="h-full w-full bg-slate-900 dark:bg-white rounded-full"></div>
<div class="absolute -bottom-2 left-1/2 h-4 w-4 -translate-x-1/2 rounded-full bg-slate-900 dark:bg-white"></div>
</div>
</div>
<div class="mt-6 flex flex-col items-center gap-1">
<span id="score" class="text-5xl font-black text-primary"></span>
<span id="status" class="text-2xl font-bold tracking-tight text-primary" data-i18n="loading">LOADING</span>
</div>
<div class="mt-10 flex flex-wrap w-full justify-between px-4 gap-3">
<div class="flex flex-col items-center md:items-center gap-1">
<span class="h-1.5 w-12 rounded-full bg-red-400"></span>
<span class="text-[10px] font-bold text-[#49699c] uppercase" data-i18n="extreme-fear">Extreme Fear</span>
</div>
<div class="flex flex-col items-center md:items-center gap-1">
<span class="h-1.5 w-12 rounded-full bg-yellow-400"></span>
<span class="text-[10px] font-bold text-[#49699c] uppercase" data-i18n="neutral">Neutral</span>
</div>
<div class="flex flex-col items-center md:items-center gap-1">
<span class="h-1.5 w-12 rounded-full bg-primary"></span>
<span class="text-[10px] font-bold text-[#49699c] uppercase" data-i18n="extreme-greed">Extreme Greed</span>
</div>
</div>
</div>
</div>

<!-- Advice/Quote Section (Replaced with Index Advisors) -->
<div class="mt-8 flex flex-col overflow-hidden rounded-xl border border-[#e7ecf4] dark:border-[#1e293b] bg-white dark:bg-[#161f2c] p-6 shadow-sm">
<div class="mb-6 flex items-center justify-between gap-2">
<h3 class="text-lg font-bold" data-i18n="index-advisors">Index Advisors</h3>
<div class="flex flex-wrap gap-2 justify-end">
<button id="advisor-gemini" class="rounded-md bg-primary/10 px-3 py-1 text-xs font-bold text-primary">Gemini</button>
<button id="advisor-gpt" class="rounded-md px-3 py-1 text-xs font-bold text-[#49699c] hover:bg-slate-100 dark:hover:bg-slate-800 transition-colors">GPT</button>
<button id="advisor-grok" class="rounded-md px-3 py-1 text-xs font-bold text-[#49699c] hover:bg-slate-100 dark:hover:bg-slate-800 transition-colors">Grok</button>
</div>
</div>

<div id="advisor-advice-display" class="mt-0 flex flex-col overflow-hidden rounded-xl border border-[#e7ecf4] dark:border-[#1e293b] bg-white dark:bg-[#161f2c] px-2 py-6 md:px-6 shadow-sm">
    <p class="text-sm dark:text-slate-200" data-i18n="updating">Gemini의 조언 준비중</p>
</div>
</div>
</div>

<!-- Historical Comparisons & Side Metrics -->
<div class="lg:col-span-4 flex flex-col gap-6">
<!-- Proverb Card -->
<div class="flex flex-col gap-4 rounded-xl border border-[#e7ecf4] dark:border-[#1e293b] bg-white dark:bg-[#161f2c] p-6 shadow-sm">
         <h4 class="text-sm font-bold text-[#49699c] uppercase tracking-wider mb-4" data-i18n="today-proverb">오늘의 주식 시장 격언</h4>
        <p id="proverb-text" class="italic text-base text-gray-800 dark:text-gray-200 min-h-[50px] flex items-center justify-center text-center break-keep" style="white-space: pre-wrap;"></p>
        <button id="generate-proverb" class="mt-4 rounded-md bg-primary/10 px-3 py-1 text-xs font-bold text-primary hover:bg-primary/20 transition-colors" data-i18n="new-proverb">새 격언 확인하기</button>
</div>

<!-- Market Indicators -->
<div class="rounded-xl border border-[#e7ecf4] dark:border-[#1e293b] bg-white dark:bg-[#161f2c] p-6 shadow-sm">
    <h4 class="mb-4 text-sm font-bold text-[#49699c] uppercase tracking-wider" data-i18n="market-indicators">Market Indicators</h4>
    <div id="fred-indicators-container" class="space-y-4">
        <p class="text-xs text-slate-400" data-i18n="loading">Loading indicators...</p>
    </div>
</div>

<!-- US Market Indices -->
<div class="rounded-xl border border-[#e7ecf4] dark:border-[#1e293b] bg-primary text-white p-6 shadow-sm">
<div class="flex items-center justify-between mb-4">
<h4 class="text-sm font-bold uppercase tracking-wider" data-i18n="sp500">S&P 500</h4>
<a href="https://www.google.com/finance/quote/.INX:INDEXSP" target="_blank"><span class="material-symbols-outlined text-white">insights</span></a>
</div>
<div class="flex flex-col gap-1">
<p id="market-index-value" class="text-3xl font-black" data-i18n="loading">Loading...</p>
<p id="market-index-date" class="text-xs text-white/70 mt-2">--:--</p>
</div>
</div>

<div class="flex flex-wrap gap-4">
    <button id="how-calculated-button" class="flex items-center gap-2 rounded-lg bg-[#e7ecf4] dark:bg-slate-800 px-4 py-2 text-sm font-bold text-[#0d131c] dark:text-white hover:opacity-80">
    <span class="material-symbols-outlined text-[18px] dark:text-white">help_outline</span>
                            <span data-i18n="how-calculated">How it's calculated</span>
                        </button>
    <button id="download-btn" class="flex items-center gap-2 rounded-lg bg-[#e7ecf4] dark:bg-slate-800 px-4 py-2 text-sm font-bold text-[#0d131c] dark:text-white hover:opacity-80">
    <span class="material-symbols-outlined text-[18px] dark:text-white">download</span>
                            <span data-i18n="export-data">Export Data</span>
                        </button>
    <button id="send-report-email-btn" class="flex items-center gap-2 rounded-lg bg-primary/10 px-4 py-2 text-sm font-bold text-primary hover:bg-primary/20">
    <span class="material-symbols-outlined text-[18px]">mail</span>
                            <span data-i18n="send-report-email">리포트 이메일로 보내기</span>
                        </button>
    </div>
</div>
</div>
</div>

<div id="indicator-explanation-section" style="display: none;" class="mt-8">
<h2 class="text-2xl font-bold mb-4 dark:text-white" data-i18n="how-calculated">지표별 계산 방식 (CNN Fear &amp; Greed)</h2>
<div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
    <div class="flex flex-col overflow-hidden rounded-xl border border-[#e7ecf4] dark:border-[#1e293b] bg-white dark:bg-[#161f2c] p-6 shadow-sm">
        <h3 class="text-lg font-bold mb-2" data-i18n="us-exp-1-title">1. 주가 모멘텀 (Stock Price Momentum)</h3>
        <p class="text-sm text-[#49699c] dark:text-slate-400" data-i18n="us-exp-1-desc">S&amp;P 500 지수와 125일 이동평균선을 비교합니다.</p>
    </div>
    <div class="flex flex-col overflow-hidden rounded-xl border border-[#e7ecf4] dark:border-[#1e293b] bg-white dark:bg-[#161f2c] p-6 shadow-sm">
        <h3 class="text-lg font-bold mb-2" data-i18n="us-exp-2-title">2. 주가 강도 (Stock Price Strength)</h3>
        <p class="text-sm text-[#49699c] dark:text-slate-400" data-i18n="us-exp-2-desc">52주 신고가와 신저가 종목 수를 비교합니다.</p>
    </div>
    <div class="flex flex-col overflow-hidden rounded-xl border border-[#e7ecf4] dark:border-[#1e293b] bg-white dark:bg-[#161f2c] p-6 shadow-sm">
        <h3 class="text-lg font-bold mb-2" data-i18n="us-exp-3-title">3. 주가 폭 (Stock Price Breadth)</h3>
        <p class="text-sm text-[#49699c] dark:text-slate-400" data-i18n="us-exp-3-desc">상승 종목과 하락 종목의 거래량을 분석합니다. (McClellan Summation Index)</p>
    </div>
    <div class="flex flex-col overflow-hidden rounded-xl border border-[#e7ecf4] dark:border-[#1e293b] bg-white dark:bg-[#161f2c] p-6 shadow-sm">
        <h3 class="text-lg font-bold mb-2" data-i18n="us-exp-4-title">4. 풋/콜 옵션 (Put and Call Options)</h3>
        <p class="text-sm text-[#49699c] dark:text-slate-400" data-i18n="us-exp-4-desc">풋 옵션과 콜 옵션의 거래량 비율을 측정합니다.</p>
    </div>
    <div class="flex flex-col overflow-hidden rounded-xl border border-[#e7ecf4] dark:border-[#1e293b] bg-white dark:bg-[#161f2c] p-6 shadow-sm">
        <h3 class="text-lg font-bold mb-2" data-i18n="us-exp-5-title">5. 시장 변동성 (Market Volatility)</h3>
        <p class="text-sm text-[#49699c] dark:text-slate-400" data-i18n="us-exp-5-desc">VIX 지수와 50일 이동평균선을 비교합니다.</p>
    </div>
    <div class="flex flex-col overflow-hidden rounded-xl border border-[#e7ecf4] dark:border-[#1e293b] bg-white dark:bg-[#161f2c] p-6 shadow-sm">
        <h3 class="text-lg font-bold mb-2" data-i18n="us-exp-6-title">6. 안전 자산 수요 (Safe Haven Demand)</h3>
        <p class="text-sm text-[#49699c] dark:text-slate-400" data-i18n="us-exp-6-desc">주식 수익률과 국채 수익률의 차이를 분석합니다.</p>
    </div>
    <div class="flex flex-col overflow-hidden rounded-xl border border-[#e7ecf4] dark:border-[#1e293b] bg-white dark:bg-[#161f2c] p-6 shadow-sm">
        <h3 class="text-lg font-bold mb-2" data-i18n="us-exp-7-title">7. 정크 본드 수요 (Junk Bond Demand)</h3>
        <p class="text-sm text-[#49699c] dark:text-slate-400" data-i18n="us-exp-7-desc">투자 등급 채권과 투기 등급 채권의 수익률 스프레드를 분석합니다.</p>
    </div>
</div>
</div>


<!-- Educational Content Section -->
<article class="mt-16 border-t border-[#e7ecf4] dark:border-[#1e293b] pt-12">
    <div class="grid grid-cols-1 md:grid-cols-2 gap-12">
        <section class="flex flex-col gap-4">
            <h2 class="text-2xl font-black dark:text-white" data-i18n="understanding-us-fng-title">미국 시장 심리 이해하기</h2>
            <p class="text-base leading-relaxed text-[#49699c] dark:text-slate-400 break-keep" data-i18n="understanding-us-fng-desc">
                미국 주식 시장은 전 세계 금융의 중심이며, 투자 심리의 변화에 매우 민감하게 반응합니다. CNN Business의 공포와 탐욕 지수는 시장의 7가지 주요 지표를 종합하여 현재의 심리 상태를 나타냅니다. 이 지수가 극단적인 공포에 도달했을 때는 시장의 반등 기회를, 극단적인 탐욕에 도달했을 때는 조정의 위험을 경고하는 신호로 활용될 수 있습니다.
            </p>
        </section>
        <section class="flex flex-col gap-4">
            <h2 class="text-2xl font-black dark:text-white" data-i18n="how-to-us-title">미국 시장 심리 활용 가이드</h2>
            <div class="space-y-4">
                <div class="p-4 rounded-lg bg-slate-50 dark:bg-slate-900/50">
                    <strong class="text-primary block mb-1" data-i18n="how-to-us-step-1-t">1단계: S&P 500 모멘텀 체크</strong>
                    <p class="text-sm text-[#49699c] dark:text-slate-400" data-i18n="how-to-us-step-1-d">CNN 지수가 지시하는 심리가 실제 S&P 500 지수의 추세와 일치하는지 확인합니다.</p>
                </div>
                <div class="p-4 rounded-lg bg-slate-50 dark:bg-slate-900/50">
                    <strong class="text-primary block mb-1" data-i18n="how-to-us-step-2-t">2단계: VIX 변동성 대조</strong>
                    <p class="text-sm text-[#49699c] dark:text-slate-400" data-i18n="how-to-us-step-2-d">공포 지수인 VIX가 급등할 때 나타나는 지수의 변화를 통해 시장의 바닥을 탐색합니다.</p>
                </div>
                <div class="p-4 rounded-lg bg-slate-50 dark:bg-slate-900/50">
                    <strong class="text-primary block mb-1" data-i18n="how-to-us-step-3-t">3단계: 글로벌 자금 흐름 관찰</strong>
                    <p class="text-sm text-[#49699c] dark:text-slate-400" data-i18n="how-to-us-step-3-d">극심한 탐욕 구간에서는 글로벌 자산 배분 전략을 통해 리스크를 분산합니다.</p>
                </div>
            </div>
        </section>
    </div>
</article>

<!-- Footer -->
<footer class="mt-12 border-t border-[#e7ecf4] dark:border-[#1e293b] pt-8 pb-12">
<p class="text-[11px] leading-relaxed text-[#49699c] dark:text-slate-500 mb-6 max-w-4xl" data-i18n="disclaimer-desc">본 정보는 참고용이며 투자 권유를 목적으로 하지 않습니다. AI 분석의 특성상 실시간 데이터 반영이 지연되거나 기술적 오류가 발생할 수 있으므로, 제공되는 수치의 정확성을 보장하지 않습니다. 실제 시장 지표와 다를 수 있으니 유의하시기 바랍니다.</p>
<div class="flex flex-wrap items-center justify-between gap-6 text-[#49699c] dark:text-slate-500">
<div class="flex flex-col gap-2">
<p class="text-sm font-medium dark:text-white" data-i18n="footer-desc-us">Data provided by CNN Business.</p>
<p class="max-w-md text-xs leading-relaxed dark:text-white" data-i18n="fng-theory">The Fear &amp; Greed Index is a way to gauge stock market movements and whether stocks are fairly priced. CNN examines seven different factors to establish how much fear and greed there is in the market.</p>
</div>
<div class="flex flex-wrap gap-4">
    <span class="text-xs font-bold text-[#49699c] dark:text-slate-400" data-i18n="contact-us">Contact: info@anse.ai.kr</span>
    <a href="/about.html" class="text-xs font-bold text-[#49699c] dark:text-slate-400 hover:text-primary transition-colors" data-i18n="about-us">서비스 소개</a>
    <a href="/terms.html" class="text-xs font-bold text-[#49699c] dark:text-slate-400 hover:text-primary transition-colors" data-i18n="terms-of-service">이용약관</a>
    <a href="/privacy.html" class="text-xs font-bold text-[#49699c] dark:text-slate-400 hover:text-primary transition-colors" data-i18n="privacy-policy">개인정보처리방침</a>
    <a href="/refund.html" class="text-xs font-bold text-[#49699c] dark:text-slate-400 hover:text-primary transition-colors" data-i18n="refund-policy">환불정책</a>
</div>
</div>
</footer>
</main>

    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-firestore.js"></script>
    <script>
      // Firebase initialization
      const firebaseConfig = {
        apiKey: "AIzaSyBumYJj1X1KrjwjWTZhGuO0B-xZJj1fLsE",
        authDomain: "anse-sample1-46739525-2d1c0.firebaseapp.com",
        projectId: "anse-sample1-46739525-2d1c0",
        storageBucket: "anse-sample1-46739525-2d1c0.firebasestorage.app",
        messagingSenderId: "164266713411",
        appId: "1:164266713411:web:31e470b1a7320aa6028ff6"
      };
      if (!firebase.apps.length) {
        firebase.initializeApp(firebaseConfig);
      }
      const db = firebase.firestore();

        // Update gauge
        function updateGauge(score) {
            const needle = document.getElementById('gauge-needle');
            const scoreDisplay = document.getElementById('score');
            const statusEl = document.getElementById('status');

            const rotationDegree = (score / 100) * 180 - 90;
            needle.style.transform = `translateX(-50%) rotate(${rotationDegree}deg)`;
            scoreDisplay.textContent = Math.round(score);

            let textColorClass = "";
            let statusKey = "";
            if (score <= 25) { textColorClass = "text-red-500"; statusKey = "extreme-fear"; } 
            else if (score <= 44) { textColorClass = "text-orange-500"; statusKey = "fear"; }
            else if (score <= 55) { textColorClass = "text-yellow-500"; statusKey = "neutral"; }
            else if (score <= 75) { textColorClass = "text-emerald-500"; statusKey = "greed"; }
            else { textColorClass = "text-blue-500"; statusKey = "extreme-greed"; }

            scoreDisplay.classList.remove("text-red-500", "text-orange-500", "text-yellow-500", "text-emerald-500", "text-blue-500", "text-primary");
            scoreDisplay.classList.add(textColorClass);
            statusEl.textContent = i18n.translate(statusKey).toUpperCase();
            statusEl.classList.remove("text-red-500", "text-orange-500", "text-yellow-500", "text-emerald-500", "text-blue-500", "text-primary");
            statusEl.classList.add(textColorClass);
            statusEl.removeAttribute('data-i18n'); // Prevent reset on lang change
        }

        // US Market Status (NYSE/NASDAQ)
        function updateUSMarketStatus() {
            const marketStatusText = document.getElementById('market-status-text');
            const marketStatusDot = document.getElementById('market-status-dot');
            const marketStatusIndicator = document.getElementById('market-status-indicator');

            // US Market Hours: 9:30 AM - 4:00 PM ET
            const now = new Date();
            const nyTime = new Intl.DateTimeFormat('en-US', {
                timeZone: 'America/New_York',
                hour: 'numeric',
                minute: 'numeric',
                hour12: false,
                weekday: 'short'
            }).formatToParts(now);

            const hour = parseInt(nyTime.find(p => p.type === 'hour').value);
            const minute = parseInt(nyTime.find(p => p.type === 'minute').value);
            const isWeekend = ['Sat', 'Sun'].includes(nyTime.find(p => p.type === 'weekday').value);

            let isOpen = false;
            if (!isWeekend) {
                const totalMinutes = hour * 60 + minute;
                if (totalMinutes >= (9 * 60 + 30) && totalMinutes < (16 * 60)) {
                    isOpen = true;
                }
            }

            if (marketStatusText && marketStatusDot && marketStatusIndicator) {
                if (isOpen) {
                    marketStatusText.textContent = i18n.translate("market-open");
                    marketStatusText.setAttribute('data-i18n', 'market-open');
                    marketStatusDot.className = 'h-2 w-2 rounded-full bg-emerald-500 animate-pulse';
                    marketStatusIndicator.className = 'flex items-center gap-2 rounded-full bg-emerald-100 dark:bg-emerald-900/30 px-6 py-2 text-xs font-bold text-emerald-600 dark:text-emerald-400';
                } else {
                    marketStatusText.textContent = i18n.translate("market-closed");
                    marketStatusText.setAttribute('data-i18n', 'market-closed');
                    marketStatusDot.className = 'h-2 w-2 rounded-full bg-red-500';
                    marketStatusIndicator.className = 'flex items-center gap-2 rounded-full bg-slate-200/60 dark:bg-slate-800/90 px-6 py-2 text-xs font-bold text-slate-400 dark:text-slate-400';
                }
            }
        }

        // Fetch latest US market data from Firestore
        async function fetchLatestUSIndex() {
            const lastUpdatedEl = document.getElementById('last-updated-time');
            const container = document.getElementById('fred-indicators-container');
            const sp500Value = document.getElementById('market-index-value');
            const sp500Date = document.getElementById('market-index-date');
            const statusEl = document.getElementById('status');

            console.log("Firestore에서 'us_index' 데이터를 불러오는 중...");

            try {
                // Get the most recent document from us_index collection
                const querySnapshot = await db.collection('us_index').orderBy('timestamp', 'desc').limit(1).get();
                
                if (!querySnapshot.empty) {
                    const data = querySnapshot.docs[0].data();
                    console.log("성공적으로 데이터를 가져왔습니다:", data);
                    
                    // 1. Update Gauge (CNN F&G)
                    if (data.fng_value !== undefined) {
                        updateGauge(data.fng_value);
                    } else {
                        console.warn("데이터에 fng_value가 없습니다.");
                        if (statusEl) statusEl.textContent = i18n.translate("loading");
                    }

                    // 2. Update Last Updated Time
                    if (data.timestamp && lastUpdatedEl) {
                        const dateObj = data.timestamp.toDate();
                        const currentLang = i18n.getLanguage();
                        const locale = currentLang === 'ko' ? 'ko-KR' : 'en-US';
                        const time = dateObj.toLocaleString(locale, { 
                            year: 'numeric', month: '2-digit', day: '2-digit', 
                            hour: '2-digit', minute: '2-digit', hour12: true 
                        }) + ' ' + i18n.translate("time-suffix");
                        lastUpdatedEl.innerHTML = `<span data-i18n="last-updated">${i18n.translate("last-updated")}</span>: ${time}`;
                    }

                    // 3. Update S&P 500 Index
                    if (sp500Value && data.sp500) {
                        const val = parseFloat(data.sp500.value);
                        sp500Value.textContent = isNaN(val) ? "N/A" : val.toLocaleString(undefined, {minimumFractionDigits: 2, maximumFractionDigits: 2});
                        if (sp500Date) sp500Date.textContent = data.sp500.date || "--:--";
                    }

                    // 4. Update Other Economic Indicators
                    const items = [
                        { id: 'fedfunds', key: 'fedfunds' },
                        { id: 'vix', key: 'vix' },
                        { id: 'payems', key: 'payems' },
                        { id: 'unrate', key: 'unrate' },
                        { id: 'dgs10', key: 'dgs10' }
                    ];

                    if (container) {
                        container.innerHTML = '';
                        items.forEach(item => {
                            const fredData = data[item.key] || {};
                            let displayValue = (fredData.value === '.' || !fredData.value) ? 'N/A' : fredData.value;
                            
                            if (displayValue !== 'N/A' && !isNaN(displayValue)) {
                                const val = parseFloat(displayValue);
                                if (item.id === 'payems') displayValue = (val/1000).toFixed(1) + 'M';
                                else if (item.id === 'unrate' || item.id === 'fedfunds' || item.id === 'dgs10') displayValue = val.toFixed(2) + '%';
                                else displayValue = val.toFixed(2);
                            }

                            container.innerHTML += `
                                <div class="flex flex-col gap-1">
                                    <div class="flex justify-between text-xs font-bold">
                                        <span class="dark:text-white" data-i18n="${item.id}">${i18n.translate(item.id)}</span>
                                        <span class="text-primary">${displayValue}</span>
                                    </div>
                                    <div class="text-[10px] text-slate-400 text-right">${fredData.date || ''}</div>
                                </div>`;
                        });
                    }
                } else {
                    console.warn("'us_index' 컬렉션이 비어있습니다.");
                    if (statusEl) statusEl.textContent = i18n.translate("loading");
                }
            } catch (error) {
                console.error("Firestore 호출 중 에러 발생:", error);
                if (statusEl) statusEl.textContent = i18n.translate("loading");
            }
        }

        function displayRandomProverb() {
            const proverbText = document.getElementById('proverb-text');
            if (proverbText) {
                const currentLang = i18n.getLanguage();
                const list = proverbs[currentLang] || proverbs.en;
                const randomIndex = Math.floor(Math.random() * list.length);
                proverbText.textContent = list[randomIndex];
            }
        }

        document.addEventListener('DOMContentLoaded', () => {
            fetchLatestUSIndex();
            updateUSMarketStatus();
            displayRandomProverb();
            document.getElementById('generate-proverb')?.addEventListener('click', displayRandomProverb);

            document.getElementById('how-calculated-button')?.addEventListener('click', () => {
                const section = document.getElementById('indicator-explanation-section');
                const isOpening = section.style.display === 'none';
                if (isOpening) {
                    section.style.display = 'block';
                    setTimeout(() => { section.scrollIntoView({ behavior: 'smooth', block: 'start' }); }, 10);
                } else {
                    section.style.display = 'none';
                }
            });

            document.getElementById('download-btn')?.addEventListener('click', function() {
                const downloadBtn = document.getElementById('download-btn');
                const originalContent = downloadBtn.innerHTML;
                if (typeof html2canvas === 'undefined') return;
                const target = document.querySelector('main.mx-auto');
                if (!target) return;
                downloadBtn.disabled = true;
                downloadBtn.textContent = "Capturing...";
                html2canvas(target, {
                    scale: 2,
                    useCORS: true,
                    backgroundColor: document.documentElement.classList.contains('dark') ? '#101722' : '#f5f7f8',
                    onclone: (clonedDoc) => {
                        const clonedMain = clonedDoc.querySelector('main');
                        if (clonedMain) {
                            clonedMain.style.margin = "0";
                            clonedMain.style.maxWidth = "none";
                            clonedMain.style.width = target.offsetWidth + "px";
                            clonedMain.style.padding = "20px";
                        }
                    }
                }).then(canvas => {
                    const link = document.createElement('a');
                    link.download = `US_Report_${new Date().toISOString().slice(0, 10)}.png`;
                    link.href = canvas.toDataURL('image/png');
                    link.click();
                }).finally(() => {
                    downloadBtn.disabled = false;
                    downloadBtn.innerHTML = originalContent;
                });
            });

            window.addEventListener('languageChanged', () => {
                fetchLatestUSIndex();
                updateUSMarketStatus();
                displayRandomProverb();
            });

            // Advisor logic
            const advisorFiles = { gemini: 'gemini_snp_adv_ko_en.html', gpt: 'gpt_snp_adv.html', grok: 'grok_snp_adv.html' };
            const advisorButtons = { gemini: document.getElementById('advisor-gemini'), gpt: document.getElementById('advisor-gpt'), grok: document.getElementById('advisor-grok') };
            const advisorAdviceDisplay = document.getElementById('advisor-advice-display');

            function updateAdvisorDisplay(activeAdvisor) {
                Object.keys(advisorButtons).forEach(id => {
                    const btn = advisorButtons[id];
                    if (!btn) return;
                    btn.className = (id === activeAdvisor) ? 'rounded-md bg-primary/10 px-3 py-1 text-xs font-bold text-primary' : 'rounded-md px-3 py-1 text-xs font-bold text-[#49699c] hover:bg-slate-100 dark:hover:bg-slate-800 transition-colors';
                });
                if (advisorAdviceDisplay) {
                    fetch(advisorFiles[activeAdvisor]).then(r => r.text()).then(html => { advisorAdviceDisplay.innerHTML = html; }).catch(() => { advisorAdviceDisplay.innerHTML = `<p class="text-sm text-red-500">${i18n.translate("failed-to-load-advice")}</p>`; });
                }
            }
            if (advisorButtons.gemini) advisorButtons.gemini.addEventListener('click', () => updateAdvisorDisplay('gemini'));
            if (advisorButtons.gpt) advisorButtons.gpt.addEventListener('click', () => updateAdvisorDisplay('gpt'));
            if (advisorButtons.grok) advisorButtons.grok.addEventListener('click', () => updateAdvisorDisplay('grok'));
            updateAdvisorDisplay('gemini');
        });

        document.getElementById('send-report-email-btn')?.addEventListener('click', async () => {
            const currentLang = document.documentElement.lang || 'ko';
            if (!confirm(i18n.translate("send-report-confirm"))) return;
            const btn = document.getElementById('send-report-email-btn');
            const originalContent = btn.innerHTML;
            const { data: { user } } = await supabaseClient.auth.getUser();
            if (!user) { alert(i18n.translate("login-required") || "로그인이 필요합니다."); return; }
            const adviceContainer = document.getElementById('advisor-advice-display');
            let filteredAdvice = "";
            if (adviceContainer) {
                const langDiv = adviceContainer.querySelector(`.lang-${currentLang}`);
                filteredAdvice = langDiv ? langDiv.innerHTML : adviceContainer.innerHTML;
            }
            const marketData = {
                score: document.getElementById('score')?.textContent,
                status: document.getElementById('status')?.textContent,
                proverb: document.getElementById('proverb-text')?.textContent,
                advice: filteredAdvice,
                kospi: { value: document.getElementById('market-index-value')?.textContent, change_rate: "", change_point: "S&P 500 INDEX", link: "https://www.google.com/finance/quote/.INX:INDEXSP" },
                indicators: []
            };
            btn.disabled = true;
            btn.innerHTML = `<span class="material-symbols-outlined text-sm animate-spin">sync</span><span>Sending...</span>`;
            try {
                const response = await fetch('/api/send-report', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ user_email: user.email, language: currentLang, market_data: marketData, market: 'us', test_mode: false })
                });
                const result = await response.json();
                if (result.success) alert(currentLang === 'ko' ? '리포트가 이메일로 발송되었습니다!' : 'Report sent!');
                else throw new Error(result.error);
            } catch (err) { alert("Error: " + err.message); } finally { btn.disabled = false; btn.innerHTML = originalContent; }
        });
    </script>
</body>
</html>