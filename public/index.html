
<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title data-i18n="title-korea">국내 금융시장 심리</title> <!-- Keep original title -->
<meta name="description" content="한국 주식시장의 공포 탐욕 지수를 확인하고 투자에 참고하세요." data-i18n="desc-korea"/> <!-- Keep original description -->
<link rel="canonical" href="https://anse.ai.kr/"/> <!-- Keep original canonical -->

<meta property="og:title" content="국내 금융시장 심리" data-i18n="title-korea"/> <!-- Keep original og tags -->
<meta property="og:description" content="한국 주식시장의 공포 탐욕 지수를 확인하고 투자에 참고하세요." data-i18n="desc-korea"/>
<meta property="og:type" content="website"/>
<meta property="og:url" content="https://anse.ai.kr/"/>
<meta property="og:image" content="https://anse.ai.kr/images/neutral.png"/>

<meta name="twitter:card" content="summary"/> <!-- Keep original twitter tags -->
<meta name="twitter:title" content="국내 금융시장 심리" data-i18n="title-korea"/>
<meta name="twitter:description" content="한국 주식시장의 공포 탐욕 지수를 확인하고 투자에 참고하세요." data-i18n="desc-korea"/>
<meta name="twitter:image" content="https://anse.ai.kr/images/neutral.png"/>

<!-- Existing styles and icons -->
<link rel="stylesheet" href="style.css"/> <!-- Keep this for now, will remove later if Tailwind replaces all -->
<link rel="icon" type="image/x-icon" href="images/favicon.ico"/>

<!-- Tailwind CSS and Fonts from code.html -->
<script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
<script src="translations.js"></script>
<script src="i18n.js"></script>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;900&amp;display=swap" rel="stylesheet"/>
<link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:wght,FILL@100..700,0..1&amp;display=swap" rel="stylesheet"/>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
<script id="tailwind-config">
        tailwind.config = {
            darkMode: "class",
            theme: {
                extend: {
                    colors: {
                        "primary": "#3d84f5",
                        "background-light": "#f5f7f8",
                        "background-dark": "#101722",
                    },
                    fontFamily: {
                        "display": ["Inter", "sans-serif"]
                    },
                    borderRadius: {"DEFAULT": "0.25rem", "lg": "0.5rem", "xl": "0.75rem", "full": "9999px"},
                },
            },
        }
    </script>
<style>
        body { font-family: 'Inter', sans-serif; }
        .material-symbols-outlined { font-variation-settings: 'FILL' 0, 'wght' 400, 'GRAD' 0, 'OPSZ' 24; }
        .gauge-gradient {
            background: conic-gradient(from 180deg at 50% 100%, #f87171 0deg, #fbbf24 90deg, #3d84f5 180deg);
        }
        /* Language-specific display rules */
        html[lang="ko"] .lang-en { display: none !important; }
        html[lang="en"] .lang-ko { display: none !important; }
    </style>

<!-- Existing Google Analytics and Clarity scripts -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-C8QR98TVTB"></script>
<script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-C8QR98TVTB');
    </script>

<script type="text/javascript">
        (function(c,l,a,r,i,t,y){
            c[a]=c[a]||function(){(c[a].q=c[a].q||[]).push(arguments)};
            t=l.createElement(r);t.async=1;t.src="https://www.clarity.ms/tag/"+i;
            y=l.getElementsByTagName(r)[0];y.parentNode.insertBefore(t,y);
        })(window, document, "clarity", "script", "v2qmp0i82b");
    </script>

<!-- Existing ld+json -->
<script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "Article",
      "headline": "국내 금융시장 심리",
      "url": "https://anse.ai.kr/",
      "description": "한국 주식시장의 공포 탐욕 지수를 확인하고 투자에 참고하세요.",
      "datePublished": "2026-01-17",
      "author": {
        "@type": "Person",
        "name": "anse"
      }
    }
    </script>


</head>
<body class="min-h-screen bg-background-light dark:bg-background-dark text-slate-900 dark:text-slate-200">
<!-- Top Navigation Bar -->
<header class="sticky top-0 z-50 w-full border-b border-solid border-[#e7ecf4] dark:border-[#1e293b] bg-white/80 dark:bg-background-dark/80 backdrop-blur-md">
<div class="mx-auto flex max-w-[1200px] items-center justify-between px-3 py-3 md:px-6">
<div class="flex items-center gap-8">
<div class="flex items-center gap-3">
<div class="flex h-8 w-8 items-center justify-center rounded-lg bg-primary shrink-0">
<span class="material-symbols-outlined text-[20px] text-white">leaderboard</span>
</div>
<h2 class="text-lg font-bold tracking-tight dark:text-white">KOSPI Fear &amp; Greed</h2>
</div>
<div class="hidden md:flex items-center gap-6"> <!-- Desktop Nav -->
<a class="text-sm font-semibold text-primary" href="/index.html" data-i18n="nav-korea">한국 금융시장 심리</a>
<a class="text-sm font-medium text-[#49699c] dark:text-slate-400 hover:text-primary transition-colors" href="/sentiment.html" data-i18n="nav-us">미국 금융 시장 심리</a>
</div>
</div>
<div class="flex flex-wrap items-center justify-end gap-2 md:gap-4">
<button id="menu-button" class="flex md:hidden h-10 w-10 items-center justify-center rounded-lg bg-[#f0f3f9] dark:bg-slate-800 text-[#0d131c] dark:text-white">
<span class="material-symbols-outlined dark:text-white">menu</span>
</button>

<button id="theme-switcher" class="flex h-10 w-10 items-center justify-center rounded-lg bg-[#f0f3f9] dark:bg-slate-800 text-[#0d131c] dark:text-white">
<span class="material-symbols-outlined dark:text-white">light_mode</span>
</button>
<div id="auth-container" class="flex items-center gap-2">
    <button id="login-button" class="hidden flex h-10 px-4 items-center justify-center rounded-lg bg-primary text-white font-bold hover:opacity-90 transition-opacity" data-i18n="login">Login</button>
    <div id="user-profile" class="hidden flex items-center gap-3">
        <div id="user-avatar" class="h-10 w-10 rounded-full bg-cover bg-center ring-2 ring-primary/20" data-alt="User profile avatar"></div>
        <button id="logout-button" class="text-xs font-bold text-[#49699c] dark:text-slate-400 hover:text-primary transition-colors" data-i18n="logout">Logout</button>
    </div>
</div>
</div>
</div>
<div id="mobile-menu" class="md:hidden hidden bg-white/80 dark:bg-background-dark/80 backdrop-blur-md pb-4 border-b border-solid border-[#e7ecf4] dark:border-[#1e293b]">
<nav class="flex flex-col items-center gap-4 py-2">
<a class="text-sm font-semibold text-primary" href="/index.html" data-i18n="nav-korea">한국 금융시장 심리</a>
<a class="text-sm font-medium text-[#49699c] dark:text-slate-400 hover:text-primary transition-colors" href="/sentiment.html" data-i18n="nav-us">미국 금융 시장 심리</a>
</nav>
</div>
</header>
<main class="mx-auto max-w-[1200px] px-6 py-8">
<!-- Page Heading -->
<div class="mb-8 flex flex-wrap items-end justify-between gap-8">
<div class="flex flex-col gap-1">
<h1 class="text-3xl font-black tracking-tight dark:text-white" data-i18n="market-sentiment-index">Market Sentiment Index</h1>
<p class="text-base text-[#49699c] dark:text-slate-400" data-i18n="kospi-analysis-desc">KOSPI fear and greed analysis based on market momentum and volatility.</p>
</div>
<div id="market-status-indicator" class="flex items-center gap-2 rounded-full bg-slate-100 dark:bg-slate-800 px-6 py-2 text-xs font-bold text-slate-600 dark:text-slate-400">
    <span id="market-status-dot" class="h-2 w-2 rounded-full bg-emerald-500 animate-pulse"></span>
    <span id="market-status-text" data-i18n="updating">Updating...</span>
</div>
<div class="grid grid-cols-1 gap-8 lg:grid-cols-12">
<!-- Main Gauge Section -->
<div class="lg:col-span-8">
<div class="flex flex-col overflow-hidden rounded-xl border border-[#e7ecf4] dark:border-[#1e293b] bg-white dark:bg-[#161f2c] p-8 shadow-sm">
<div class="mb-4 flex flex-wrap items-center justify-between gap-3">
<h3 class="text-lg font-bold" data-i18n="current-sentiment">Current Sentiment</h3>
<span id="last-updated-time" class="text-sm font-medium text-[#49699c]"><span data-i18n="last-updated">마지막 업데이트</span>: 14:30 KST</span>
</div>
<div class="relative flex flex-col items-center py-10">
<!-- Gauge visualization -->
<div class="relative h-48 w-80 overflow-hidden rounded-t-full bg-slate-100 dark:bg-slate-800">
<!-- Gauge segments colored with conic gradient simulated as a semicircular background -->
<div class="absolute inset-0 gauge-gradient opacity-80" style="clip-path: polygon(0 0, 100% 0, 100% 100%, 0 100%);"></div>
<div class="absolute bottom-0 left-1/2 h-32 w-64 -translate-x-1/2 rounded-t-full bg-white dark:bg-[#161f2c]"></div>
<!-- Needle -->
<div class="absolute bottom-0 left-1/2 h-40 w-1 -translate-x-1/2 origin-bottom transition-transform duration-1000 ease-out" id="gauge-needle">
<div class="h-full w-full bg-slate-900 dark:bg-white rounded-full"></div>
<div class="absolute -bottom-2 left-1/2 h-4 w-4 -translate-x-1/2 rounded-full bg-slate-900 dark:bg-white"></div>
</div>
</div>
<div class="mt-6 flex flex-col items-center gap-1">
<span id="score" class="text-5xl font-black text-primary"></span>
<span id="status" class="text-2xl font-bold tracking-tight text-primary">GREED</span>
</div>
<div class="mt-10 flex flex-wrap w-full justify-between px-4 gap-3">
<div class="flex flex-col items-center md:items-center gap-1">
<span class="h-1.5 w-12 rounded-full bg-red-400"></span>
<span class="text-[10px] font-bold text-[#49699c] uppercase" data-i18n="extreme-fear">Extreme Fear</span>
</div>
<div class="flex flex-col items-center md:items-center gap-1">
<span class="h-1.5 w-12 rounded-full bg-yellow-400"></span>
<span class="text-[10px] font-bold text-[#49699c] uppercase" data-i18n="neutral">Neutral</span>
</div>
<div class="flex flex-col items-center md:items-center gap-1">
<span class="h-1.5 w-12 rounded-full bg-primary"></span>
<span class="text-[10px] font-bold text-[#49699c] uppercase" data-i18n="extreme-greed">Extreme Greed</span>
</div>
</div>
</div>
</div>
<!-- 30-Day Trend Chart -->
<div class="mt-8 flex flex-col overflow-hidden rounded-xl border border-[#e7ecf4] dark:border-[#1e293b] bg-white dark:bg-[#161f2c] p-6 shadow-sm">
<div class="mb-6 flex items-center justify-between gap-2">
<h3 class="text-lg font-bold" data-i18n="index-advisors">Index Advisors</h3>
<div class="flex flex-wrap gap-2 justify-end">
<button id="advisor-gemini" class="rounded-md bg-primary/10 px-3 py-1 text-xs font-bold text-primary">Gemini</button>
<button id="advisor-gpt" class="rounded-md px-3 py-1 text-xs font-bold text-[#49699c] hover:bg-slate-100 dark:hover:bg-slate-800 transition-colors">GPT</button>
<button id="advisor-grok" class="rounded-md px-3 py-1 text-xs font-bold text-[#49699c] hover:bg-slate-100 dark:hover:bg-slate-800 transition-colors">Grok</button>
</div>
</div>


<div id="advisor-advice-display" class="mt-0 flex flex-col overflow-hidden rounded-xl border border-[#e7ecf4] dark:border-[#1e293b] bg-white dark:bg-[#161f2c] px-2 py-6 md:px-6 shadow-sm">
    <p class="text-sm dark:text-slate-200" data-i18n="updating">Gemini의 조언 준비중</p>
</div>


<div id="index-history-container" class="h-64 w-full relative"> <!-- Added ID and relative for absolute positioning -->
    <div id="chart-placeholder" class="absolute inset-0 flex items-center justify-center text-lg font-bold text-[#49699c]" data-i18n="preparing-data">
        Preparing data...
    </div>
    <div id="index-history-chart" class="h-full w-full" style="display: none;"> <!-- Added ID and initially hidden -->
        <svg class="h-full w-full" preserveaspectratio="none" viewbox="0 0 1000 200">
        <!-- Area background -->
        <path class="opacity-10" d="M0 160 Q 100 140, 200 150 T 400 120 T 600 80 T 800 100 T 1000 60 L 1000 200 L 0 200 Z" fill="url(#chartGradient)"></path>
        <!-- Line -->
        <path d="M0 160 Q 100 140, 200 150 T 400 120 T 600 80 T 800 100 T 1000 60" fill="none" stroke="#3d84f5" stroke-linecap="round" stroke-width="3"></path>
        <defs>
        <lineargradient id="chartGradient" x1="0" x2="0" y1="0" y2="1">
        <stop offset="0%" stop-color="#3d84f5"></stop>
        <stop offset="100%" stop-color="#3d84f5" stop-opacity="0"></stop>
        </lineargradient>
        </defs>
        </svg>
        <div class="mt-4 flex justify-between text-[11px] font-bold text-[#49699c]">
        <span>30 DAYS AGO</span>
        <span>20 DAYS AGO</span>
        <span>10 DAYS AGO</span>
        <span>TODAY</span>
        </div>
    </div>
</div>
</div>
</div>




<!-- Historical Comparisons & Side Metrics -->
<div class="lg:col-span-4 flex flex-col gap-6">
<!-- Comparison Cards -->
<div class="grid grid-cols-1 gap-4">
<div class="flex flex-col gap-4 rounded-xl border border-[#e7ecf4] dark:border-[#1e293b] bg-white dark:bg-[#161f2c] p-6 shadow-sm">
         <h4 class="text-sm font-bold text-[#49699c] uppercase tracking-wider mb-4" data-i18n="today-proverb">오늘의 주식 시장 격언</h4>
        <p id="proverb-text" class="italic text-base text-gray-800 dark:text-gray-200 min-h-[50px] flex items-center justify-center text-center break-keep" style="white-space: pre-wrap;"></p>
        <button id="generate-proverb" class="mt-4 rounded-md bg-primary/10 px-3 py-1 text-xs font-bold text-primary hover:bg-primary/20 transition-colors" data-i18n="new-proverb">새 격언 확인하기</button>
</div>
<!-- Market Indicators section -->
<div class="rounded-xl border border-[#e7ecf4] dark:border-[#1e293b] bg-white dark:bg-[#161f2c] p-6 shadow-sm">
    <h4 class="mb-4 text-sm font-bold text-[#49699c] uppercase tracking-wider" data-i18n="market-indicators">Market Indicators</h4>
    <div id="dynamic-indicators-container" class="space-y-4">
        <!-- Dynamic indicators will be injected here by JavaScript -->
    </div>
</div>
</div>
<!-- Market Indices Quick View -->
<div class="rounded-xl border border-[#e7ecf4] dark:border-[#1e293b] bg-primary text-white p-6 shadow-sm">
<div class="flex items-center justify-between mb-4">
<h4 class="text-sm font-bold uppercase tracking-wider">KOSPI</h4>
<a href="https://finance.naver.com/sise/" target="_blank"><span class="material-symbols-outlined">insights</span></a>
</div>
<div class="flex flex-col gap-1">
<p id="kospi-value" class="text-3xl font-black" data-i18n="loading">Loading...</p>
<div class="flex items-center gap-2">
<span id="kospi-change-rate" class="text-sm font-bold bg-white/20 px-2 py-0.5 rounded"></span>
<span id="kospi-change-point" class="text-sm text-white/80"></span>
</div>
</div>
<p id="kospi-last-updated" class="text-xs text-white/70 mt-2"></p>
</div>

<div class="flex flex-wrap gap-4">
    <button id="how-calculated-button" class="flex items-center gap-2 rounded-lg bg-[#e7ecf4] dark:bg-slate-800 px-4 py-2 text-sm font-bold text-[#0d131c] dark:text-white hover:opacity-80">
    <span class="material-symbols-outlined text-[18px] dark:text-white">help_outline</span>
                            <span data-i18n="how-calculated">How it's calculated</span>
                        </button>
    <button id="download-btn" class="flex items-center gap-2 rounded-lg bg-[#e7ecf4] dark:bg-slate-800 px-4 py-2 text-sm font-bold text-[#0d131c] dark:text-white hover:opacity-80">
    <span class="material-symbols-outlined text-[18px] dark:text-white">download</span>
                            <span data-i18n="export-data">Export Data</span>
                        </button>
    </div>
</div>
</div>
</div>

<div id="indicator-explanation-section" style="display: none;" class="mt-8">
<h2 class="text-2xl font-bold mb-4 dark:text-white" data-i18n="exp-title-korea">지표별 계산 방식 및 스케일링</h2>
<div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
    <div class="flex flex-col overflow-hidden rounded-xl border border-[#e7ecf4] dark:border-[#1e293b] bg-white dark:bg-[#161f2c] p-6 shadow-sm">
        <h3 class="text-lg font-bold mb-2" data-i18n="exp-1-title">1. KOSPI vs 125일 이평선 이격도 (시장 모멘텀)</h3>
        <p class="text-sm text-[#49699c] dark:text-slate-400 mb-2" data-i18n="exp-1-desc">
            코스피 지수가 125일 이동평균선과 얼마나 떨어져 있는지를 나타내는 지표입니다. 이격도가 크면 과매수(탐욕), 작으면 과매도(공포)로 해석합니다.
        </p>
        <p class="text-sm font-semibold text-primary dark:text-emerald-400" data-i18n="exp-1-scaling">
            <strong>스케일링:</strong> 이격도 0.9 이하 → 0점 (극심한 공포), 이격도 1.1 이상 → 100점 (극심한 탐욕). 0.9 ~ 1.1 범위에서 선형적으로 스케일링됩니다.
        </p>
    
    </div>
    <div class="flex flex-col overflow-hidden rounded-xl border border-[#e7ecf4] dark:border-[#1e293b] bg-white dark:bg-[#161f2c] p-6 shadow-sm">
        <h3 class="text-lg font-bold mb-2" data-i18n="exp-2-title">2. KOSPI 14일 RSI (주가 강도)</h3>
        <p class="text-sm text-[#49699c] dark:text-slate-400 mb-2" data-i18n="exp-2-desc">
            KOSPI 지수의 14일 상대강도지수(RSI)를 사용하여 주가의 상승 및 하락 강도를 측정합니다. RSI가 낮으면 과매도(공포), 높으면 과매수(탐욕)로 해석합니다.
        </p>
        <p class="text-sm font-semibold text-primary dark:text-emerald-400" data-i18n="exp-2-scaling">
            <strong>스케일링:</strong> RSI 값 0 ~ 100을 그대로 0점 ~ 100점으로 스케일링합니다. 0점은 극심한 공포, 100점은 극심한 탐욕을 나타냅니다.
        </p>
    </div>
    <div class="flex flex-col overflow-hidden rounded-xl border border-[#e7ecf4] dark:border-[#1e293b] bg-white dark:bg-[#161f2c] p-6 shadow-sm">
        <h3 class="text-lg font-bold mb-2" data-i18n="exp-3-title">3. ADR (상승/하락 비율) (시장 폭)</h3>
        <p class="text-sm text-[#49699c] dark:text-slate-400 mb-2" data-i18n="exp-3-desc">
            일정 기간 동안 상승한 종목 수와 하락한 종목 수의 비율을 나타내는 지표입니다. ADR이 낮으면 시장 전반의 하락세(공포), 높으면 상승세(탐욕)를 의미합니다.
        </p>
        <p class="text-sm font-semibold text-primary dark:text-emerald-400" data-i18n="exp-3-scaling">
            <strong>스케일링:</strong> ADR 70 이하 → 0점 (극심한 공포), ADR 120 이상 → 100점 (극심한 탐욕). 70 ~ 120 범위에서 선형적으로 스케일링됩니다.
        </p>
    </div>
    <div class="flex flex-col overflow-hidden rounded-xl border border-[#e7ecf4] dark:border-[#1e293b] bg-white dark:bg-[#161f2c] p-6 shadow-sm">
        <h3 class="text-lg font-bold mb-2" data-i18n="exp-4-title">4. VKOSPI (변동성) (시장 변동성)</h3>
        <p class="text-sm text-[#49699c] dark:text-slate-400 mb-2" data-i18n="exp-4-desc">
            코스피200 변동성 지수(VKOSPI)는 시장의 예상 변동성을 나타내며, 투자자들의 공포 심리를 반영합니다. VKOSPI 값이 높으면 시장의 불확실성 증가(공포), 낮으면 안정(탐욕)으로 해석합니다.
        </p>
        <p class="text-sm font-semibold text-primary dark:text-emerald-400" data-i18n="exp-4-scaling">
            <strong>스케일링:</strong> VKOSPI 40 이상 → 0점 (극심한 공포), VKOSPI 10 이하 → 100점 (극심한 탐욕). 10 ~ 40 범위에서 역비례하여 선형적으로 스케일링됩니다.
        </p>
    </div>
    <div class="flex flex-col overflow-hidden rounded-xl border border-[#e7ecf4] dark:border-[#1e293b] bg-white dark:bg-[#161f2c] p-6 shadow-sm">
        <h3 class="text-lg font-bold mb-2" data-i18n="exp-5-title">5. 코스피200 옵션 풋콜 비율 (옵션 풋콜 비율)</h3>
        <p class="text-sm text-[#49699c] dark:text-slate-400 mb-2" data-i18n="exp-5-desc">
            코스피200 옵션 시장에서 풋옵션 거래량과 콜옵션 거래량의 비율을 나타내는 지표입니다. 풋옵션 거래량(하락에 베팅)이 많으면 공포, 콜옵션 거래량(상승에 베팅)이 많으면 탐욕으로 해석합니다.
        </p>
        <p class="text-sm font-semibold text-primary dark:text-emerald-400" data-i18n="exp-5-scaling">
            <strong>스케일링:</strong> PCR 1.8 이상 → 0점 (극심한 공포), PCR 0.6 이하 → 100점 (극심한 탐욕). 0.6 ~ 1.8 범위에서 역비례하여 선형적으로 스케일링됩니다.
        </p>
    </div>
    <div class="flex flex-col overflow-hidden rounded-xl border border-[#e7ecf4] dark:border-[#1e293b] bg-white dark:bg-[#161f2c] p-6 shadow-sm">
        <h3 class="text-lg font-bold mb-2" data-i18n="exp-6-title">6. 최종 공포 탐욕 지수 계산</h3>
        <p class="text-sm text-[#49699c] dark:text-slate-400 mb-2" data-i18n="exp-6-desc">
            최종 공포 탐욕 지수는 위 5가지 지표들의 가중 평균을 통해 산출됩니다. 각 지표는 시장 심리 분석에 있어 서로 다른 중요도를 가지므로, 다음과 같은 가중치를 적용합니다.
        </p>
        <ul class="text-sm font-semibold list-disc pl-5">
            <li class="text-primary dark:text-emerald-400" data-i18n="exp-6-list-1"><strong>지표 1 (KOSPI vs 125일 이평선 이격도):</strong> 25%</li>
            <li class="text-primary dark:text-emerald-400" data-i18n="exp-6-list-2"><strong>지표 2 (KOSPI 14일 RSI):</strong> 20%</li>
            <li class="text-primary dark:text-emerald-400" data-i18n="exp-6-list-3"><strong>지표 3 (ADR):</strong> 20%</li>
            <li class="text-primary dark:text-emerald-400" data-i18n="exp-6-list-4"><strong>지표 4 (VKOSPI):</strong> 20%</li>
            <li class="text-primary dark:text-emerald-400" data-i18n="exp-6-list-5"><strong>지표 5 (코스피200 옵션 풋콜 비율):</strong> 15%</li>
        </ul>
        <p class="text-sm text-[#49699c] dark:text-slate-400 mt-2" data-i18n="exp-6-footer">
            이러한 가중치를 통해 시장의 다양한 측면을 종합적으로 반영한 공포 탐욕 지수를 제공합니다.
        </p>
    </div>
</div>
</div>

<!-- Footer / Data Source -->
<footer class="mt-12 border-t border-[#e7ecf4] dark:border-[#1e293b] pt-8 pb-12">
<div class="flex flex-wrap items-center justify-between gap-6 text-[#49699c] dark:text-slate-500">
<div class="flex flex-col gap-2">
<p class="text-sm font-medium dark:text-white" data-i18n="footer-desc-korea">Data provided by KRX (Korea Exchange) and KOFIA.</p>
<p class="max-w-md text-xs leading-relaxed dark:text-white" data-i18n="fng-theory">The Fear &amp; Greed Index is a way to gauge stock market movements and whether stocks are fairly priced. The theory is based on the logic that excessive fear tends to drive down share prices, and too much greed tends to have the opposite effect.</p>
</div>
<div class="flex gap-4">
    <a href="/privacy.html" class="flex items-center gap-2 rounded-lg bg-[#e7ecf4] dark:bg-slate-800 px-4 py-2 text-sm font-bold text-[#0d131c] dark:text-white hover:opacity-80">
    <span class="material-symbols-outlined text-[18px] dark:text-white">policy</span>
                            <span data-i18n="privacy-policy">개인정보처리방침</span>
                        </a>
    </div>

</div>
</footer>
</main>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-firestore.js"></script>
    <script>
      // Firebase initialization
      const firebaseConfig = {
        apiKey: "AIzaSyBumYJj1X1KrjwjWTZhGuO0B-xZJj1fLsE",
        authDomain: "anse-sample1-46739525-2d1c0.firebaseapp.com",
        projectId: "anse-sample1-46739525-2d1c0",
        storageBucket: "anse-sample1-46739525-2d1c0.firebasestorage.app",
        messagingSenderId: "164266713411",
        appId: "1:164266713411:web:31e470b1a7320aa6028ff6"
      };
      if (!firebase.apps.length) {
        firebase.initializeApp(firebaseConfig);
      }
      const db = firebase.firestore();

        // Function to update gauge needle rotation and sentiment text/color
        function updateGauge(score) {
            const needle = document.getElementById('gauge-needle');
            const scoreDisplay = document.getElementById('score');
            const sentimentText = document.getElementById('status'); // Ref to sentiment text for color update

            // Map score 0-100 to rotation -90 to 90 degrees
            const rotationDegree = (score / 100) * 180 - 90;
            needle.style.transform = `translateX(-50%) rotate(${rotationDegree}deg)`;

            scoreDisplay.textContent = score;

            // Determine color and status based on score
            let textColorClass = "";
            let statusKey = "";
            if (score <= 25) { textColorClass = "text-red-500"; statusKey = "extreme-fear"; }
            else if (score <= 45) { textColorClass = "text-orange-500"; statusKey = "fear"; }
            else if (score <= 55) { textColorClass = "text-yellow-500"; statusKey = "neutral"; }
            else if (score <= 75) { textColorClass = "text-emerald-500"; statusKey = "greed"; }
            else { textColorClass = "text-blue-500"; statusKey = "extreme-greed"; }

            // Apply color to score display, preserving font size and other text styles
            scoreDisplay.classList.remove("text-red-500", "text-orange-500", "text-yellow-500", "text-emerald-500", "text-blue-500", "text-primary"); // Remove all possible color classes
            scoreDisplay.classList.add(textColorClass);
            
            // Apply color and translated text to sentiment text
            sentimentText.textContent = i18n.translate(statusKey).toUpperCase();
            sentimentText.classList.remove("text-red-500", "text-orange-500", "text-yellow-500", "text-emerald-500", "text-blue-500", "text-primary"); // Remove all possible color classes
            sentimentText.classList.add(textColorClass);
        }

        // KOSPI Market Status Update logic (defined globally for accessibility)
        function updateKOSPIStatus(marketStatusText, marketStatusDot, marketStatusIndicator) {
            const now = new Date();
            const currentUTCDay = now.getUTCDay(); // 0 for Sunday, 1 for Monday, ..., 6 for Saturday
            const currentUTCHour = now.getUTCHours();
            const currentUTCMinute = now.getUTCMinutes();

            // KOSPI market hours in UTC: Monday-Friday, 00:00 UTC (9:00 KST) to 06:30 UTC (15:30 KST)
            const marketOpenUTCHour = 0; // 09:00 KST
            const marketOpenUTCMinute = 0;
            const marketCloseUTCHour = 6; // 15:30 KST
            const marketCloseUTCMinute = 30;

            const isWeekday = currentUTCDay >= 1 && currentUTCDay <= 5; // Monday to Friday UTC
            
            let isOpen = false;
            if (isWeekday) {
                if (currentUTCHour > marketOpenUTCHour && currentUTCHour < marketCloseUTCHour) {
                    isOpen = true;
                } else if (currentUTCHour === marketOpenUTCHour && currentUTCMinute >= marketOpenUTCMinute) {
                    isOpen = true;
                } else if (currentUTCHour === marketCloseUTCHour && currentUTCMinute <= marketCloseUTCMinute) {
                    isOpen = true;
                }
            }
            

            if (isOpen) {
                marketStatusText.textContent = i18n.translate("market-open");
                marketStatusText.removeAttribute('data-i18n');
                marketStatusDot.classList.remove('bg-red-500', 'bg-slate-400');
                marketStatusDot.classList.add('bg-emerald-500', 'animate-pulse');
                marketStatusIndicator.classList.remove('bg-slate-100', 'dark:bg-slate-800', 'text-slate-600', 'dark:text-slate-400');
                marketStatusIndicator.classList.add('bg-emerald-100', 'dark:bg-emerald-900/30', 'text-emerald-600', 'dark:text-emerald-400');
                // Explicitly set text color for marketStatusText
                marketStatusText.classList.remove('text-slate-600', 'dark:text-slate-400', 'text-red-500');
                marketStatusText.classList.add('text-emerald-600', 'dark:text-emerald-400');
                
            } else {
                marketStatusText.textContent = i18n.translate("market-closed");
                marketStatusText.removeAttribute('data-i18n');
                marketStatusDot.classList.remove('bg-emerald-500', 'animate-pulse');
                marketStatusDot.classList.add('bg-red-500');
                marketStatusIndicator.classList.remove('bg-emerald-100', 'dark:bg-emerald-900/30', 'text-emerald-600', 'dark:text-emerald-400');
                marketStatusIndicator.classList.add('bg-slate-200/60', 'dark:bg-slate-800/90', 'text-slate-600', 'dark:text-slate-400');
                // Explicitly set text color for marketStatusText
                marketStatusText.classList.remove('text-emerald-600', 'dark:text-emerald-400');
                marketStatusText.classList.add('text-slate-400', 'dark:text-slate-400');        

            }
        }

        async function fetchLatestIndex() {
            const scoreEl = document.getElementById('score');
            const statusEl = document.getElementById('status');
            const lastUpdatedTimeEl = document.getElementById('last-updated-time');
            const indicatorDetailsEl = document.getElementById('indicator-details');
            const indicatorListEl = document.getElementById('indicator-list');
            const indicatorAvgEl = document.getElementById('indicator-avg');

            // New elements for chart placeholder 
            const chartPlaceholderEl = document.getElementById('chart-placeholder');
            const indexHistoryChartEl = document.getElementById('index-history-chart'); 
            
                        // New elements for KOSPI Quick View
            
                        const kospiValueEl = document.getElementById('kospi-value');
            
                        const kospiChangeRateEl = document.getElementById('kospi-change-rate');
            
                        const kospiChangePointEl = document.getElementById('kospi-change-point');
            
                        const kospiLastUpdatedEl = document.getElementById('kospi-last-updated');
            
                        const dynamicIndicatorsContainer = document.getElementById('dynamic-indicators-container'); // Get new container reference
            
            
            
                        // 로딩 상태 표시
            
                        statusEl.textContent = i18n.translate("loading"); 
            
                        if (chartPlaceholderEl) chartPlaceholderEl.style.display = 'flex'; // Show placeholder while loading
            
                        if (indexHistoryChartEl) indexHistoryChartEl.style.display = 'none';
            
                        if (dynamicIndicatorsContainer) dynamicIndicatorsContainer.innerHTML = `<p class="text-sm text-[#49699c] dark:text-slate-400">${i18n.translate("loading")}</p>`;
            
            
            
            
            
                        // KOSPI Quick View 로딩 상태
            
                        kospiValueEl.textContent = i18n.translate("loading");
            
                        kospiChangeRateEl.textContent = "";
            
                        kospiChangePointEl.textContent = "";
            
                        kospiLastUpdatedEl.textContent = "";
            
            
            
                        try {
            
                            const q = db.collection("korea_index").orderBy("timestamp", "desc").limit(1);
            
                            const querySnapshot = await q.get();
            
            
            
                            if (!querySnapshot.empty) {
            
                                                                const doc = querySnapshot.docs[0].data();
            
                                                                const score = doc.score;
            
                                                                const statusFromFirestore = doc.status; // This will be the object
            
                                                                const timestamp = doc.timestamp.toDate(); // Corrected line
            
                                                                
            
                                                                // Localize time formatting
            
                                                                const currentLang = i18n.getLanguage();
            
                                                                const locale = currentLang === 'ko' ? 'ko-KR' : 'en-US';
            
                                                                const formattedTime = timestamp.toLocaleString(locale, { 
            
                                                                    year: 'numeric', month: '2-digit', day: '2-digit', 
            
                                                                    hour: '2-digit', minute: '2-digit', hour12: false 
            
                                                                });
            
                                                                
            
                                                                const timeSuffix = i18n.translate("time-suffix");
            
                                                                
            
                                                                // Update main score, sentiment, and gauge
            
                                                                updateGauge(score); // This handles needle and score color/value
            
                                                                
            
                                                                lastUpdatedTimeEl.textContent = `${i18n.translate("last-updated")}: ${formattedTime} ${timeSuffix}`; 
            
                                
            
                                
            
                                
            
            
            
                                const indicators = [];
            
                                                                for (let i = 1; i <= 5; i++) {
            
                                                                    const indicatorKey = `indicator${i}`;
            
                                                                    if (doc[indicatorKey] !== undefined) {
            
                                                                        indicators.push({
            
                                                                            id: i,
            
                                                                            name: i18n.translate(`indicator${i}`),
            
                                                                            value: doc[indicatorKey]
            
                                                                        });
            
                                                                    }
            
                                                                }
            
            
            
                                if (indicators.length > 0) {
            
                                    dynamicIndicatorsContainer.innerHTML = ''; // Clear previous loading content
            
                                    indicators.forEach(item => {
            
                                        const indicatorValue = item.value.toFixed(2);
            
                                        let valueColorClass = "text-[#49699c]"; // Default color for text
            
                                        let progressBarColorClass = "bg-[#49699c]"; // Default color for progress bar
            
            
            
                                        // Determine color based on value for progress bar and text
            
                                        if (item.value <= 25) { 
            
                                            valueColorClass = "text-red-400";
            
                                            progressBarColorClass = "bg-red-400";
            
                                        } else if (item.value <= 45) { 
            
                                            valueColorClass = "text-orange-400";
            
                                            progressBarColorClass = "bg-orange-400";
            
                                        } else if (item.value <= 55) { 
            
                                            valueColorClass = "text-yellow-400";
            
                                            progressBarColorClass = "bg-yellow-400";
            
                                        } else if (item.value <= 75) { 
            
                                            valueColorClass = "text-emerald-500";
            
                                            progressBarColorClass = "bg-emerald-500";
            
                                        } else { 
            
                                            valueColorClass = "text-primary"; // blue for greed
            
                                            progressBarColorClass = "bg-primary";
            
                                        }
            
            
            
                                        const indicatorHtml = `
            
                                            <div class="flex flex-col gap-1">
            
                                                <div class="flex justify-between text-xs font-bold">
            
                                                    <span class="dark:text-white">${item.name}</span>
            
                                                    <span class="${valueColorClass}">${indicatorValue}</span>
            
                                                </div>
            
                                                <div class="h-1.5 w-full rounded-full bg-slate-100 dark:bg-slate-800">
            
                                                    <div class="h-full rounded-full ${progressBarColorClass}" style="width: ${indicatorValue}%;"></div>
            
                                                </div>
            
                                            </div>
            
                                        `;
            
                                        dynamicIndicatorsContainer.insertAdjacentHTML('beforeend', indicatorHtml);
            
                                    });
            
                                } else {
            
                                    dynamicIndicatorsContainer.innerHTML = '<p class="text-sm text-[#49699c] dark:text-slate-400">지표 데이터를 찾을 수 없습니다.</p>';
            
                                }
            
            
            
                                // Chart data handling (placeholder for now)
            
                                // Assuming doc.historicalChartData will be available eventually
            
                                // For now, it will always show "Preparing data..."
            
                                if (doc.historicalChartData) { // Placeholder condition for future chart data
            
                                    chartPlaceholderEl.style.display = 'none';
            
                                    indexHistoryChartEl.style.display = 'block';
            
                                    // Render chart here when data is available
            
                                } else {
            
                                    chartPlaceholderEl.style.display = 'flex'; // Use flex for centering
            
                                    indexHistoryChartEl.style.display = 'none';
            
                                }
            
            
            
                                // Populate KOSPI Quick View from Firestore
            
                                const kospi_value = doc.kospi_value;
            
                                const kospi_change_point = doc.kospi_change_point;
            
                                const kospi_change_rate = doc.kospi_change_rate;
            
            
            
                                if (kospi_value !== undefined && kospi_change_point !== undefined && kospi_change_rate !== undefined) {
                                    kospiValueEl.textContent = kospi_value.toFixed(2);
                                    kospiValueEl.removeAttribute('data-i18n'); // Prevent reset on lang change
                                    kospiChangeRateEl.textContent = `${kospi_change_rate > 0 ? '+' : ''}${kospi_change_rate.toFixed(2)}%`;
                                    kospiChangePointEl.textContent = `${kospi_change_point > 0 ? '▲' : '▼'} ${Math.abs(kospi_change_point).toFixed(2)}`;
                                    
                                    const updatedAtLabel = i18n.translate("updated-at");
                                    kospiLastUpdatedEl.textContent = `${updatedAtLabel}: ${formattedTime} ${timeSuffix}`; 
            
            
            
                                    // Apply color for change
            
                                    kospiChangeRateEl.classList.remove('bg-emerald-500/20', 'bg-red-500/20', 'bg-white/20');
            
                                    kospiChangePointEl.classList.remove('text-emerald-500/80', 'text-red-500/80', 'text-white/80');
            
            
            
                                    if (kospi_change_point > 0) {
            
                                        kospiChangeRateEl.classList.add('bg-emerald-500/20');
            
                                        kospiChangePointEl.classList.add('text-emerald-500/80');
            
                                    } else if (kospi_change_point < 0) {
            
                                        kospiChangeRateEl.classList.add('bg-red-500/20');
            
                                        kospiChangePointEl.classList.add('text-red-500/80');
            
                                    } else {
            
                                        kospiChangeRateEl.classList.add('bg-white/20'); // Neutral color
            
                                        kospiChangePointEl.classList.add('text-white/80'); // Neutral color
            
                                    }
            
                                } else {
            
                                    kospiValueEl.textContent = "N/A";
            
                                    kospiChangeRateEl.textContent = "N/A";
            
                                    kospiChangePointEl.textContent = "N/A";
            
                                    kospiLastUpdatedEl.textContent = "KOSPI 데이터 없음";
            
                                }
            
            
            
                            } else {
            
                                statusEl.textContent = i18n.translate("preparing-data");
            
                                if (chartPlaceholderEl) chartPlaceholderEl.style.display = 'flex'; // Show placeholder if no data
            
                                if (indexHistoryChartEl) indexHistoryChartEl.style.display = 'none';
            
                                if (dynamicIndicatorsContainer) dynamicIndicatorsContainer.innerHTML = `<p class="text-sm text-[#49699c] dark:text-slate-400">${i18n.translate("preparing-data")}</p>`;
            
                                kospiValueEl.textContent = "N/A";
            
                                kospiChangeRateEl.textContent = "N/A";
            
                                kospiChangePointEl.textContent = "N/A";
            
                                kospiLastUpdatedEl.textContent = i18n.translate("preparing-data");
            
                            }
            
                        } catch (error) {
            
                            console.error("Firebase 오류: ", error);
            
                            statusEl.textContent = i18n.translate("loading");
            
                            if (chartPlaceholderEl) chartPlaceholderEl.style.display = 'flex'; // Show placeholder on error
            
                            if (indexHistoryChartEl) indexHistoryChartEl.style.display = 'none';
            
                            if (dynamicIndicatorsContainer) dynamicIndicatorsContainer.innerHTML = `<p class="text-sm text-[#49699c] dark:text-slate-400">${i18n.translate("loading")}</p>`;
            
                            kospiValueEl.textContent = "N/A";
            
                            kospiChangeRateEl.textContent = "N/A";
            
                            kospiChangePointEl.textContent = "N/A";
            
                            kospiLastUpdatedEl.textContent = i18n.translate("loading");
            
                        } finally {
            
                            // Main score, sentiment, and last updated time are always displayed
            
                            scoreEl.style.display = 'block';
            
                            statusEl.style.display = 'block';
            
                            lastUpdatedTimeEl.style.display = 'block';
            
                        }
            
                    }

        const proverbs = {
            ko: [
                "“시장은 단기적으로 투표기계지만 장기적으로 저울이다.”\n→ 벤저민 그레이엄 (Benjamin Graham)",
                "“잃지 않는 것이 버는 것보다 중요하다.”\n→ 워런 버핏 (Warren Buffett)",
                "“첫 번째 규칙은 돈을 잃지 않는 것이다. 두 번째 규칙은 첫 번째 규칙을 잊지 않는 것이다.”\n→ 워런 버핏",
                "“훌륭한 기업을 적당한 가격에 사라.”\n→ 워런 버핏 / 찰리 멍거",
                "“위험은 자신이 무엇을 하고 있는지 모를 때 생긴다.”\n→ 워런 버핏",
                "“공포 속에서 사고 탐욕 속에서 팔아라.”\n→ 워런 버핏 / 월가 격언",
                "“시장은 인내심 없는 사람의 돈을 인내심 있는 사람에게서 옮겨준다.”\n→ 워런 버핏",
                "“가격은 지불하는 것이고 가치는 얻는 것이다.”\n→ 워런 버핏",
                "“이해하지 못하는 사업에는 투자하지 마라.”\n→ 워런 버핏",
                "“10년 이상 보유할 생각이 없다면 10분도 보유하지 마라.”\n→ 워런 버핏",
                "“추세는 당신의 친구다.”\n→ 제시 리버모어 (Jesse Livermore)",
                "“손실은 짧게, 이익은 길게 가져가라.”\n→ 제시 리버모어",
                "“시장은 항상 옳다.”\n→ 제시 리버모어 (의미상 격언)",
                "“강세장은 비관 속에서 태어나 회의 속에서 자라고 낙관 속에서 성숙하며 도취 속에서 죽는다.”\n→ 존 템플턴 (John Templeton)",
                "“이번엔 다르다는 말이 가장 위험하다.”\n→ 존 템플턴",
                "“기다리는 것도 포지션이다.”\n→ 월가 격언",
                "“현금도 투자다.”\n→ 월가 격언",
                "“절대 바닥에서 못 사고 꼭대기에서 못 판다.”\n→ 월가 격언",
                "“칼 떨어질 때 잡지 마라.”\n→ 월가 격언",
                "“소문에 사고 뉴스에 팔아라.”\n→ 월가 격언",
                "“모두가 같은 방향을 볼 때 위험은 커진다.”\n→ 월가 격언",
                "“시장은 당신의 감정을 시험한다.”\n→ 월가 격언",
                "“확신이 클수록 조심하라.”\n→ 월가 격언",
                "“거래가 잦을수록 수익률은 낮아진다.”\n→ 브래드 바버 & 테런스 오딘 (행동재무학 연구)",
                "“시장에 머무는 시간이 시장을 맞추는 것보다 중요하다.”\n→ 투자 격언 (Bogle 계열 인용)",
                "“복리는 세계 8대 불가사의다.”\n→ 알버트 아인슈타인 (투자 격언으로 인용)",
                "“시간은 좋은 기업의 편이다.”\n→ 워런 버핏",
                "“숫자를 보지 않고 주식을 사는 것은 계기판 없는 비행기를 타는 것과 같다.”\n→ 피터 린치 (Peter Lynch)",
                "“스토리가 아니라 실적을 사라.”\n→ 피터 린치 (의미 요약)",
                "“가장 위험한 시점은 모두가 안심할 때다.”\n→ 하워드 막스 (Howard Marks)",
                "“리스크는 변동성이 아니라 영구적 자본 손실이다.”\n→ 하워드 막스",
                "“좋은 투자란 나쁜 시나리오에서도 버티는 것이다.”\n→ 하워드 막스",
                "“높은 수익은 높은 불편함에서 나온다.”\n→ 하워드 막스",
                "“시장은 과잉 반응한다.”\n→ 로버트 실러 (Robert Shiller)",
                "“분산투자는 무지를 인정하는 행위다.”\n→ 워런 버핏",
                "“가장 좋은 매수 시점은 모두가 팔고 싶을 때다.”\n→ 월가 격언",
                "“싸게 사는 것이 수익의 절반이다.”\n→ 벤저민 그레이엄",
                "“시장은 언제나 과도하게 낙관적이거나 비관적이다.”\n→ 벤저민 그레이엄",
                "“손절은 선택이 아니라 생존이다.”\n→ 트레이더 격언",
                "“포트폴리오는 수익이 아니라 리스크로 관리하라.”\n→ 레이 달리오 (Ray Dalio)",
                "“미래를 예측하지 말고 대비하라.”\n→ 레이 달리오",
                "“좋은 투자자는 예측보다 원칙에 의존한다.”\n→ 레이 달리오",
                "“시장은 합리적이지 않을 수 있다, 하지만 오래 비합리적이진 않다.”\n→ 존 메이너드 케인즈 (John M. Keynes)",
                "“시장은 당신이 파산하기 전에 비이성적으로 남아 있을 수 있다.”\n→ 존 메이너드 케인즈",
                "“레버리지는 실수를 치명적으로 만든다.”\n→ 월가 격언",
                "“수익은 인내에서 나오고 손실은 조급함에서 나온다.”\n→ 월가 격언",
                "“완벽한 타이밍은 없다.”\n→ 투자 격언",
                "“하락장은 나쁜 기업을 드러낸다.”\n→ 월가 격언",
                "“좋은 기업은 위기에서 더 강해진다.”\n→ 워런 버핏 (의미 인용)",
                "“투자에서 가장 중요한 단어는 ‘영원히’가 아니라 ‘충분히 오래’다.”\n→ 하워드 막스 (의미 인용)"
            ],
            en: [
                "“In the short run, the market is a voting machine but in the long run, it is a weighing machine.”\n→ Benjamin Graham",
                "“It's not whether you're right or wrong that's important, but how much money you make when you're right and how much you lose when you're wrong.”\n→ Warren Buffett",
                "“Rule No. 1: Never lose money. Rule No. 2: Never forget rule No. 1.”\n→ Warren Buffett",
                "“It's far better to buy a wonderful company at a fair price than a fair company at a wonderful price.”\n→ Warren Buffett / Charlie Munger",
                "“Risk comes from not knowing what you're doing.”\n→ Warren Buffett",
                "“Be fearful when others are greedy and greedy when others are fearful.”\n→ Warren Buffett",
                "“The stock market is a device for transferring money from the impatient to the patient.”\n→ Warren Buffett",
                "“Price is what you pay. Value is what you get.”\n→ Warren Buffett",
                "“Never invest in a business you cannot understand.”\n→ Warren Buffett",
                "“If you aren't willing to own a stock for ten years, don't even think about owning it for ten minutes.”\n→ Warren Buffett",
                "“The trend is your friend.”\n→ Jesse Livermore",
                "“Cut your losses short and let your profits run.”\n→ Jesse Livermore",
                "“Markets are never wrong – opinions often are.”\n→ Jesse Livermore",
                "“Bull markets are born on pessimism, grown on skepticism, mature on optimism and die on euphoria.”\n→ John Templeton",
                "“The four most dangerous words in investing are: 'This time it's different.'”\n→ John Templeton",
                "“Waiting is also a position.”\n→ Wall Street Proverb",
                "“Cash is also an investment.”\n→ Wall Street Proverb",
                "“You can't buy at the very bottom or sell at the very top.”\n→ Wall Street Proverb",
                "“Don't try to catch a falling knife.”\n→ Wall Street Proverb",
                "“Buy the rumor, sell the news.”\n→ Wall Street Proverb",
                "“When everyone is looking in the same direction, risk increases.”\n→ Wall Street Proverb",
                "“The market will test your emotions.”\n→ Wall Street Proverb",
                "“The more certain you are, the more cautious you should be.”\n→ Wall Street Proverb",
                "“The more active the trader, the less money they make.”\n→ Brad Barber & Terence Odean",
                "“Time in the market beats timing the market.”\n→ Investment Proverb",
                "“Compound interest is the eighth wonder of the world.”\n→ Albert Einstein",
                "“Time is the friend of the wonderful company, the enemy of the mediocre.”\n→ Warren Buffett",
                "“Investing without looking at the numbers is like driving a car without a dashboard.”\n→ Peter Lynch",
                "“Buy the business, not the story.”\n→ Peter Lynch",
                "“The most dangerous time is when everyone feels safe.”\n→ Howard Marks",
                "“Risk is not volatility; it is the permanent loss of capital.”\n→ Howard Marks",
                "“Good investing is about surviving the bad scenarios.”\n→ Howard Marks",
                "“High returns come from high discomfort.”\n→ Howard Marks",
                "“Markets overreact in both directions.”\n→ Robert Shiller",
                "“Diversification is protection against ignorance.”\n→ Warren Buffett",
                "“The best time to buy is when everyone wants to sell.”\n→ Wall Street Proverb",
                "“Buying cheap is half the profit.”\n→ Benjamin Graham",
                "“Markets are always either too optimistic or too pessimistic.”\n→ Benjamin Graham",
                "“Cutting losses is not a choice, it is survival.”\n→ Trader Proverb",
                "“Manage risk, not returns.”\n→ Ray Dalio",
                "“Don't predict the future, prepare for it.”\n→ Ray Dalio",
                "“Successful investors rely on principles, not predictions.”\n→ Ray Dalio",
                "“The market can be irrational, but it won't stay irrational forever.”\n→ John Maynard Keynes",
                "“The market can remain irrational longer than you can remain solvent.”\n→ John Maynard Keynes",
                "“Leverage makes mistakes fatal.”\n→ Wall Street Proverb",
                "“Profits come from patience, losses come from haste.”\n→ Wall Street Proverb",
                "“There is no such thing as perfect timing.”\n→ Investment Proverb",
                "“Bear markets reveal bad companies.”\n→ Wall Street Proverb",
                "“Wonderful companies become stronger through a crisis.”\n→ Warren Buffett",
                "“In investing, the most important word is not 'forever', but 'long enough'.”\n→ Howard Marks"
            ]
        };

        function displayRandomProverb() {
            const proverbText = document.getElementById('proverb-text');
            if (proverbText) {
                const currentLang = i18n.getLanguage();
                const list = proverbs[currentLang] || proverbs.en;
                const randomIndex = Math.floor(Math.random() * list.length);
                proverbText.textContent = list[randomIndex];
            }
        }

        // --- Theme Switcher Logic ---
        const updateThemeIcon = (isDarkMode) => {
            const icon = document.querySelector('#theme-switcher .material-symbols-outlined');
            if (icon) {
                icon.textContent = isDarkMode ? 'dark_mode' : 'light_mode';
            }
        };

        const applySavedTheme = () => {
            const savedTheme = localStorage.getItem('theme');
            const isDarkMode = savedTheme === 'dark';
            if (isDarkMode) {
                document.documentElement.classList.add('dark');
                updateThemeIcon(true);
            } else {
                document.documentElement.classList.remove('dark');
                updateThemeIcon(false);
            }
        };

        document.addEventListener('DOMContentLoaded', async () => {
            applySavedTheme(); // Apply saved theme on page load
            const themeSwitcher = document.getElementById('theme-switcher');
            if (themeSwitcher) {
                themeSwitcher.addEventListener('click', () => {
                    const isDarkMode = document.documentElement.classList.toggle('dark');
                    if (isDarkMode) {
                        localStorage.setItem('theme', 'dark');
                    } else {
                        localStorage.removeItem('theme');
                    }
                    updateThemeIcon(isDarkMode);
                });
            }

            await fetchLatestIndex(); // Call fetchLatestIndex first
            displayRandomProverb(); // Then display proverb
            const generateProverbButton = document.getElementById('generate-proverb');
            if (generateProverbButton) {
                generateProverbButton.addEventListener('click', displayRandomProverb); // Set up button listener
            }

            // Mobile menu toggle logic
            const menuButton = document.getElementById('menu-button');
            const mobileMenu = document.getElementById('mobile-menu');

            if (menuButton && mobileMenu) {
                menuButton.addEventListener('click', () => {
                    mobileMenu.classList.toggle('hidden');
                });
            }

            // KOSPI Market Status Update logic
            const marketStatusText = document.getElementById('market-status-text');
            const marketStatusDot = document.getElementById('market-status-dot');
            const marketStatusIndicator = document.getElementById('market-status-indicator'); // Parent div for color changes



            // Call it initially and set an interval for updates
            updateKOSPIStatus(marketStatusText, marketStatusDot, marketStatusIndicator);
            setInterval(() => updateKOSPIStatus(marketStatusText, marketStatusDot, marketStatusIndicator), 60 * 1000); // Update every minute

            // Toggle indicator explanation section
            const howCalculatedButton = document.getElementById('how-calculated-button');
            const indicatorExplanationSection = document.getElementById('indicator-explanation-section');

            if (howCalculatedButton && indicatorExplanationSection) {
                howCalculatedButton.addEventListener('click', () => {
                    const isOpening = indicatorExplanationSection.style.display === 'none';
                    if (isOpening) {
                        indicatorExplanationSection.style.display = 'block';
                        // Small timeout to ensure DOM has rendered the block before scrolling
                        setTimeout(() => {
                            indicatorExplanationSection.scrollIntoView({ behavior: 'smooth', block: 'start' });
                        }, 10);
                    } else {
                        indicatorExplanationSection.style.display = 'none';
                    }
                });
            }


            const advisorFiles = {
                gemini: 'gemini_adv_ko_en.html',
                gpt: 'gpt_adv.html', // Placeholder for future GPT advice file
                grok: 'grok_adv.html' // Placeholder for future Grok advice file
            };

            const advisorGeminiBtn = document.getElementById('advisor-gemini');
            const advisorGptBtn = document.getElementById('advisor-gpt');
            const advisorGrokBtn = document.getElementById('advisor-grok');
            const advisorAdviceDisplay = document.getElementById('advisor-advice-display');

            const advisorButtons = [advisorGeminiBtn, advisorGptBtn, advisorGrokBtn];

            function updateAdvisorDisplay(activeAdvisor) {
                // Reset all buttons to inactive state
                advisorButtons.forEach(button => {
                    button.classList.remove('bg-primary/10', 'text-primary');
                    button.classList.add('text-[#49699c]', 'hover:bg-slate-100', 'dark:hover:bg-slate-800');
                });

                // Set active advisor button state
                let currentActiveButton;
                if (activeAdvisor === 'gemini') {
                    currentActiveButton = advisorGeminiBtn;
                } else if (activeAdvisor === 'gpt') {
                    currentActiveButton = advisorGptBtn;
                } else if (activeAdvisor === 'grok') {
                    currentActiveButton = advisorGrokBtn;
                }

                if (currentActiveButton) {
                    currentActiveButton.classList.remove('text-[#49699c]', 'hover:bg-slate-100', 'dark:hover:bg-slate-800');
                    currentActiveButton.classList.add('bg-primary/10', 'text-primary');
                }

                // Dynamically load content for advisor advice display
                if (advisorAdviceDisplay) {
                    const filePath = advisorFiles[activeAdvisor];
                    if (filePath) {
                        fetch(filePath)
                            .then(response => {
                                if (!response.ok) {
                                    throw new Error(`HTTP error! status: ${response.status}`);
                                }
                                return response.text();
                            })
                            .then(htmlContent => {
                                advisorAdviceDisplay.innerHTML = htmlContent;
                            })
                            .catch(error => {
                                console.error(`Error loading advisor advice for ${activeAdvisor}:`, error);
                                advisorAdviceDisplay.innerHTML = `<p class="text-sm text-red-500">${i18n.translate("failed-to-load-advice")}</p>`;
                            });
                    } else {
                        // Fallback for advisors without a dedicated file
                        advisorAdviceDisplay.innerHTML = `<p class="text-sm dark:text-slate-200">${i18n.translate("preparing-advice")}</p>`;
                    }
                }
            }

            // Add event listeners to advisor buttons
            if (advisorGeminiBtn) {
                advisorGeminiBtn.addEventListener('click', () => updateAdvisorDisplay('gemini'));
            }
            if (advisorGptBtn) {
                advisorGptBtn.addEventListener('click', () => updateAdvisorDisplay('gpt'));
            }
            if (advisorGrokBtn) {
                advisorGrokBtn.addEventListener('click', () => updateAdvisorDisplay('grok'));
            }

            // Set initial advisor (Gemini) on page load
            updateAdvisorDisplay('gemini');

            // Listen for language changes to refresh dynamic content
            window.addEventListener('languageChanged', async () => {
                await fetchLatestIndex();
                displayRandomProverb(); // Refresh proverb too
                updateKOSPIStatus(marketStatusText, marketStatusDot, marketStatusIndicator); // Refresh market status text
            });
        });
    </script>
    <script>
    document.addEventListener('DOMContentLoaded', function() {
    document.getElementById('download-btn').addEventListener('click', function() {
        // 1. 캡처 대상: body 대신 리포트 본문인 'main' 태그를 지정
        const target = document.querySelector('main'); 

        if (!target) {
            alert("캡처할 리포트 영역(main)을 찾을 수 없습니다.");
            return;
        }

        // 2. 캡처 옵션 설정
        html2canvas(target, {
            allowTaint: true,
            useCORS: true,
            scale: 2,           // 고해상도 설정
            backgroundColor: "#f8f9fa", // 배경색(투명 방지)
            
            // [핵심] 현재 스크롤 위치를 무시하고 요소의 절대 좌표(0,0)부터 전체를 계산
            scrollX: 0,
            scrollY: 0,
            windowWidth: target.scrollWidth,
            windowHeight: target.scrollHeight,
            width: target.scrollWidth,
            height: target.scrollHeight,
            
            // 복제본 생성 시 스크롤을 맨 위로 강제 고정하여 여백 방지
            onclone: (clonedDoc) => {
                const clonedMain = clonedDoc.querySelector('main');
                if (clonedMain) {
                    clonedMain.style.padding = "0";
                    clonedMain.style.margin = "0";
                }
            }
        }).then(canvas => {
            // 3. 파일 다운로드 실행
            const link = document.createElement('a');
            link.download = 'anse_full_report.png';
            link.href = canvas.toDataURL('image/png');
            link.click();
        }).catch(err => {
            console.error("캡처 오류:", err);
        });
    });
});

    </script>
    <script>
        // Supabase configuration - Hardcoded for local development
        const SB_URL = 'https://bksuhgixknsqzzxahuni.supabase.co'; 
        const SB_KEY = 'sb_publishable_K47Ui76Xyb5hqjAOqJsbYg_u0ZFJTdf';
        
        let supabaseClient;
        try {
            console.log("Initializing Supabase (Hardcoded)...");
            if (!SB_URL.startsWith('http')) {
                throw new Error("Supabase URL is not provided.");
            }
            const { createClient } = supabase;
            supabaseClient = createClient(SB_URL, SB_KEY);
            console.log("Supabase Client initialized successfully.");
        } catch (e) {
            console.error("Supabase Initialization Error:", e.message);
            const btn = document.getElementById('login-button');
            if (btn) btn.classList.remove('hidden');
        }

        const loginButton = document.getElementById('login-button');
        const logoutButton = document.getElementById('logout-button');
        const userProfile = document.getElementById('user-profile');
        const userAvatar = document.getElementById('user-avatar');

        async function updateAuthState() {
            if (!supabaseClient) return;
            
            try {
                // getUser() can throw or return error if session is missing
                const { data: { user }, error } = await supabaseClient.auth.getUser();
                
                if (user) {
                    console.log("User session found:", user.email);
                    loginButton.classList.add('hidden');
                    userProfile.classList.remove('hidden');
                    if (user.user_metadata.avatar_url) {
                        userAvatar.style.backgroundImage = `url('${user.user_metadata.avatar_url}')`;
                    }
                } else {
                    // No session - this is normal for guests
                    loginButton.classList.remove('hidden');
                    userProfile.classList.add('hidden');
                }
            } catch (err) {
                // Silent catch for initial load
                loginButton.classList.remove('hidden');
                userProfile.classList.add('hidden');
            }
        }

        if (loginButton) {
            loginButton.addEventListener('click', async () => {
                console.log("Login button clicked.");
                if (!supabaseClient) {
                    const msg = "Supabase configuration missing. Please ensure NEXT_PUBLIC_SUPABASE_URL and NEXT_PUBLIC_SUPABASE_ANON_KEY are set in Cloudflare.";
                    console.error(msg);
                    alert(msg);
                    return;
                }
                
                const { error } = await supabaseClient.auth.signInWithOAuth({
                    provider: 'google',
                    options: {
                        queryParams: {
                            prompt: 'select_account',
                            access_type: 'offline',
                        },
                        redirectTo: window.location.origin
                    }
                });
                if (error) {
                    console.error('OAuth Login Error:', error.message);
                    alert("Login failed: " + error.message);
                }
            });
        }

        if (logoutButton) {
            logoutButton.addEventListener('click', async () => {
                console.log("Logout button clicked.");
                if (!supabaseClient) return;
                const { error } = await supabaseClient.auth.signOut();
                if (error) {
                    console.error('Logout Error:', error.message);
                } else {
                    console.log("Logout successful.");
                    updateAuthState();
                }
            });
        }

        // Initialize auth state
        if (supabaseClient) {
            supabaseClient.auth.onAuthStateChange((event, session) => {
                console.log("Auth State Changed Event:", event);
                updateAuthState();
            });
            updateAuthState();
        }
    </script>
</body>
</html>